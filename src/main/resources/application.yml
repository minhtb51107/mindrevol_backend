# ===================================================================
# CẤU HÌNH CHO TÍNH NĂNG CACHE THÔNG MINH
# ===================================================================
application:
  cache:
    # Ngưỡng tương đồng (similarity) để coi một câu hỏi là trùng khớp trong cache.
    # Giá trị này phụ thuộc vào toán tử bạn dùng trong PGVector:
    # - Nếu dùng L2 distance (<->), giá trị càng thấp càng tốt (ví dụ: 0.15)
    # - Nếu dùng Cosine similarity (<=>), giá trị càng gần 1.0 càng tốt (ví dụ: 0.95)
    # Bắt đầu với một giá trị an toàn.
    similarity-threshold: 0.95

# ==========================
# Datasource & Hikari Config
# ==========================
spring:
  datasource:
    hikari:
      # Thời gian tối đa một kết nối được tồn tại trong pool (ms). 
      # Hãy đặt thấp hơn thời gian timeout của DB. Ví dụ: 10 phút.
      max-lifetime: 600000 
      # Thời gian một kết nối được phép nhàn rỗi (ms). Ví dụ: 5 phút.
      idle-timeout: 300000
      # Thời gian chờ để có được kết nối từ pool (ms).
      connection-timeout: 30000 
      # Một câu lệnh SQL đơn giản để kiểm tra kết nối có còn sống không.
      connection-test-query: "SELECT 1"

  data:
    redis:
      repositories:
        enabled: false
  flyway:
    repair: true # Thêm cấu hình flyway vào đây

# ==========================
# App Config
# ==========================
app:
  default-pipeline-name: "default-rag"

# Loại bỏ cấp "definitions" thừa
pipelines:
  default-rag:
    steps:
      - retrieval
      - reranking
      - generation
  simple-rag:
    steps:
      - retrieval
      - generation

# ... các cấu hình khác của bạn
# Thêm cấu hình cho bước retrieval
retrieval:
  max-results: 50 # Số lượng tài liệu tối đa lấy ra để đưa cho reranker

# ==========================
# API Keys
# ==========================
serper:
  api:
    key: "88167f39e2136998ff9cfdb9ec1c89b781e49934"

weather:
  api:
    key: "4cc89aa50518ec1d08113963d6239d59"

fmp:
  api:
    key: "d3c257pr01qu1259be90d3c257pr01qu1259be9g"
